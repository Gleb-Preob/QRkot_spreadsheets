# Проект QRkot_spreadseets
Проект QRkot_spreadseets - это реализация API благотворительного фонда на основании технологии FastAPI, с возможностью выгружать статистику о закрытых проектах в таблицу Google Sheets.

![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)
![FastAPI](https://img.shields.io/badge/FastAPI-005571?style=for-the-badge&logo=fastapi)
![SQLAlchemy](https://img.shields.io/badge/SQLAlchemy-306998?logo=python&logoColor=white)
![Google Cloud Platform](https://img.shields.io/badge/-Google%20Cloud%20Platform-4285F4?style=flat&logo=google%20cloud&logoColor=white)


## Технологии:
- Python 3.9
- FastAPI 0.78.0
- SQLAlchemy 1.4.36
- Aiogoogle 4.2.0


## Возможности

Интерфейс API позволяет:
1. Анонимным пользователям
* просматривать все благотворительные проекты и их прогресс финансирования

2. Зарегистрированным пользователям добавляется возможность:
* отправлять данные о сумме пожертвования с комментарием (реализовано как простые текстовые данные в json)
* просматривать историю своих пожертвований

3. Супер-пользователь так же может:
* создавать и редактировать проекты
* просматривать пожертвования всех пользователей
* для каждого пожертвования видеть прогресс вложения

* отправить запрос для выгрузки данных в таблицу google sheets: выгружаются закрытые проекты, и сортируются в зависимости от времени, которое заняло финансирование проекта

Бэкенд API автоматически направляет все свободные средства в благотворительные проекты по принципу очереди (First In, First Out)


## Как развернуть проект

#### 1. Виртуальное окружение
Достаточно склонировать репозиторий, развернуть виртуальное окружение, и установить зависимости из файла:

```
python -m venv venv
source venv/Scripts/activate
python -m pip install --upgrade pip
pip install -r requirements.txt
```

#### 2. Заполнение переменных окружения
В главной директории проекта ознакомьтесь с файлом `.env.example` - в нём указаны переменные окружения и их значения по умолчанию.
Создайте файл `.env`, в него скопируйте содержимое `.env.example`, после чего дополните или замените параметры на подходящие для вашего проекта.

Комментарием в файле отмечено начало блока переменных для доступа к аккаунту Google Cloud Platform -- заполните их соответственно файлу, который платформа предоставляет после регистрации сервисного аккаунта

#### 3. Создание файла базы данных

1. Для выполнения миграций и создания пустой базы данных используйте команду Alembic:

```
alembic upgrade head
```

2. Суперпользователь.
Сервер разработки запускается из корневой директории проекта.
Создание суперпользователя произойдёт автоматически при первом запуске сервера.

Запуск тестового сервера:
```
uvicorn app.main:app --reload
```

Сервер запускается на порте 8000
Если потребуется, можно изменить порт, добавив к команде флаг `--port 8001`

## Готово
Если на платформе Google Cloud создан аккаунт, заполнен файл `.env`, произведены миграции и запущен сервер, то приложение должно быть доступно по адресу 
[http://127.0.0.1:8000](http://127.0.0.1:8000)

Графический интерфейс формируется автоматически FastAPI по следующим адресам
* Взаимодействие с API: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
* Просмотр спецификаций: [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc)


## Автор
[Gleb-Preob](https://github.com/Gleb-Preob)